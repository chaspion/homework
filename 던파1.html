<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>21세기 컴퓨터 주제 출판 책 보기</title>
    <!-- JQuery를 import 합니다 -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style type="text/css">
        div.question-box {
            color: white;
            margin: 10px 0 20px 0;
            background-image: url("https://i.ytimg.com/vi/uWLPVqP-Sqo/maxresdefault.jpg");
            background-position: center;
        }

        table {
            border: 1px solid;
            border-collapse: collapse;
        }

        td,
        th {
            padding: 10px;
            border: 1px solid;
        }

        .background-center {
            text-align: center;
            margin-left: auto;
            margin-right: auto;
        }
    </style>

    <script>
        function serverID(string) {
            if(string === "카인") {
                return "cain";
            }
            if(string === "디레지에") {
                return "diregie";
            }
            if(string === "시로코") {
                return "siroco";

            }if(string === "프레이") {
                return "prey";
            }
            if(string === "카시야스") {
                return "casillas";
            }
            if(string === "힐더") {
                return "hilder";
            }
            if(string === "안톤") {
                return "anton";
            }
            if(string === "바칼") {
                return "bakal";
            }
        }

        
        function showCharInfo() {
            $('#df-char').empty();

            let serName = $('#server-name').val();
            let charName = $('#char-name').val();
            let charEncode = encodeURIComponent(charName);
            if(serName === '' && charName === ''){
                alert('서버명과 캐릭터명을 전부 입력하세요.')
            }
            let dfurl = "https://cors-anywhere.herokuapp.com/https://api.neople.co.kr/df/servers/" + serverID(serName) +
                "/characters?apikey=u24sm4DgTGNKceFknyhar93DXxuHX9pN&characterName=" + charEncode

            $.ajax({
                type: "GET",
                url: dfurl,
                data: {},
                success: (response) => {
                    let charInfo = response["rows"];

                    let charName = charInfo[0]['characterName'];
                    let charClass = charInfo[0]['jobName'];
                    let charJob = charInfo[0]['jobGrowName'];
                    let charLevel = charInfo[0]['level'];
                    let charId = charInfo[0]['characterId']
                    let charServer = charInfo[0]['serverId']

                    let charImg = "https://img-api.neople.co.kr/df/servers/" + charServer + "/characters/"
                                    + charId + "?zoom=2"
                    let element = `<tr><td>${charName}</td><td>${charClass}</td><td>${charJob}</td><td>${charLevel}</td></tr>`


                    $('#df-char').append(element)

                    $('#img-char').attr("src", charImg)
                }
            })
        }


    </script>

</head>
<body>
<h1>네오플 API로 테스트 by.압도로스</h1>

<hr/>

<div class="background-center">
    <h1>던전앤파이터 캐릭터 정보 불러오기</h1>
    <h3>서버 입력 <input type="text" id = "server-name"> </h3>
    <h3>캐릭터명 입력 <input type="text" id = "char-name"> </h3>
    <button onclick="showCharInfo()" id = "btn-post-box">캐릭터 정보 검색</button>
    </p>
    <table class="background-center">
        <thead>
        <tr>
            <td>캐릭터명</td>
            <td>직업</td>
            <td>각성</td>
            <td>레벨</td>
        </tr>
        </thead>
        <!--  tbody 에 정보를 업데이트 하려면 어떻게 해야할까요? 힌트! 가리킨다(select)      -->
        <tbody id = "df-char">
        </tbody>
    </table>
    </p>
<!--    <table class="background-center">-->
<!--        <thead>-->
<!--        <tr>-->
<!--            <td>힘</td>-->
<!--            <td>지능</td>-->
<!--            <td>물리 공격</td>-->
<!--            <td>마법 공격</td>-->
<!--        </tr>-->
<!--        </thead>-->
<!--        &lt;!&ndash;  tbody 에 정보를 업데이트 하려면 어떻게 해야할까요? 힌트! 가리킨다(select)      &ndash;&gt;-->
<!--        <tbody id = "df-status">-->
<!--        </tbody>-->
<!--    </table>-->
    <div>
    <img id="img-char" src="https://developers.neople.co.kr/img/logo_t1.png" />
    </div>
</div>


</body>
</html>